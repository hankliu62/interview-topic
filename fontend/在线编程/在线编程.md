<!--
 * @owner: hank.liu
 * @team: å¡é²ç§‹
-->

# å¸¸è§çš„æ‰‹å†™ä»£ç  é¢è¯•çŸ¥è¯†ç‚¹æ€»ç»“

æœ¬éƒ¨åˆ†ä¸»è¦æ˜¯ç¬”è€…åœ¨å¤ä¹  å¸¸è§çš„æ‰‹å†™ä»£ç çš„é€šç”¨é¢˜ç›® ç›¸å…³çŸ¥è¯†å’Œä¸€äº›ç›¸å…³é¢è¯•é¢˜æ—¶æ‰€åšçš„ç¬”è®°ï¼Œä¸»è¦æ˜¯ä¸ªäººå¤ä¹ ä½¿ç”¨ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œå¸Œæœ›å¹¶æ„Ÿè°¢å¤§å®¶æŒ‡å‡ºï¼Œå¦‚æ€»ç»“ç­”æ¡ˆä¸æ ‡å‡†æœ‰å‡ºå…¥ï¼Œè¯·è½»å–·ï¼Œè°¢è°¢ğŸ™


## æœ‰ä¸€å †æ•´æ•°ï¼Œè¯·æŠŠä»–ä»¬åˆ†æˆä¸‰ä»½ï¼Œç¡®ä¿æ¯ä¸€ä»½å’Œå°½é‡ç›¸ç­‰ï¼ˆ11ï¼Œ42ï¼Œ23ï¼Œ4ï¼Œ5ï¼Œ6, 4, 5, 6, 11, 23, 42, 56, 78, 90ï¼‰

``` js
function f1(arr, count) {
  // æ•°ç»„ä»å¤§åˆ°å°æ’åº
  arr.sort((a, b) => b - a);
  // è®¡ç®—å¹³å‡å€¼
  let avg = arr.reduce((a,b) => a + b) / count;
  let resArr = [];
  let current = 0;

  // ä»å¤§åˆ°å°æ±‚å’Œï¼Œå–æœ€æ¥è¿‘å¹³å‡å€¼çš„ä¸€ç»„ï¼Œæ”¾å…¥äºŒç»´æ•°ç»„
  for (let i = 0; i < count - 1; i++) {
    if (current + arr[arr.length-1] / 2 < avg && i) {
      arr.pop();
      resArr[i-1].push(arr[arr.length-1]);
    }
    current = 0;
    resArr[i] = [];
    arr.forEach((item, index) => {
      current += item;
      arr.splice(index,1);
      resArr[i].push(item);
      if (current > avg) {
        current -= item;
        arr.splice(index,0,item);
        resArr[i].pop();
      }
    });
  }

  resArr[count-1] = arr;

  return resArr;
}
//æµ‹è¯•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ•°ç»„ï¼Œç¬¬äºŒä¸ªä¸ºä»½æ•°
console.log(f1([11,42,23,4,5,6,4,5,6,11,23,42,56,78,90], 3))
```

## å®ç° lodash çš„_.get

åœ¨ js ä¸­ç»å¸¸ä¼šå‡ºç°åµŒå¥—è°ƒç”¨è¿™ç§æƒ…å†µï¼Œå¦‚ a.b.c.d.eï¼Œä½†æ˜¯è¿™ä¹ˆå†™å¾ˆå®¹æ˜“æŠ›å‡ºå¼‚å¸¸ã€‚ä½ éœ€è¦è¿™ä¹ˆå†™ a && a.b && a.b.c && a.b.c.d && a.b.c.d.eï¼Œä½†æ˜¯æ˜¾å¾—æœ‰äº›å•°å—¦ä¸å†—é•¿äº†ã€‚ç‰¹åˆ«æ˜¯åœ¨ graphql ä¸­ï¼Œè¿™ç§åµŒå¥—è°ƒç”¨æ›´æ˜¯éš¾ä»¥é¿å…ã€‚

è¿™æ—¶å°±éœ€è¦ä¸€ä¸ª get å‡½æ•°ï¼Œä½¿ç”¨ get(a, 'b.c.d.e') ç®€å•æ¸…æ™°ï¼Œå¹¶ä¸”å®¹é”™æ€§æé«˜äº†å¾ˆå¤šã€‚

### 1ï¼‰ä»£ç å®ç°

``` js
function get(source, path, defaultValue = undefined) {
  // a[3].b -> a.3.b -> [a,3,b]
 // path ä¸­ä¹Ÿå¯èƒ½æ˜¯æ•°ç»„çš„è·¯å¾„ï¼Œå…¨éƒ¨è½¬åŒ–æˆ . è¿ç®—ç¬¦å¹¶ç»„æˆæ•°ç»„
  const paths = path.replace(/\[(\d+)\]/g, ".$1").split(".");
  let result = source;
  for (const p of paths) {
    // æ³¨æ„ null ä¸ undefined å–å±æ€§ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥ä½¿ç”¨ Object åŒ…è£…ä¸€ä¸‹ã€‚
    result = Object(result)[p];
    if (result == undefined) {
      return defaultValue;
    }
  }
  return result;
}
// æµ‹è¯•ç”¨ä¾‹
console.log(get({ a: null }, "a.b.c", 3)); // output: 3
console.log(get({ a: undefined }, "a", 3)); // output: 3
console.log(get({ a: null }, "a", 3)); // output: 3
console.log(get({ a: [{ b: 1 }] }, "a[0].b", 3)); // output: 1
```

## å®ç° add(1)(2)(3)

è€ƒç‚¹ï¼šå‡½æ•°æŸ¯é‡ŒåŒ–

å‡½æ•°æŸ¯é‡ŒåŒ–æ¦‚å¿µï¼š æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰æ˜¯æŠŠæ¥å—å¤šä¸ªå‚æ•°çš„å‡½æ•°è½¬å˜ä¸ºæ¥å—ä¸€ä¸ªå•ä¸€å‚æ•°çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥å—ä½™ä¸‹çš„å‚æ•°ä¸”è¿”å›ç»“æœçš„æ–°å‡½æ•°çš„æŠ€æœ¯ã€‚

### 1ï¼‰ç²—æš´ç‰ˆ

``` js
function add (a) {
  return function (b) {
    return function (c) {
      return a + b + c;
    }
  }
}
console.log(add(1)(2)(3)); // 6
```

### 2ï¼‰æŸ¯é‡ŒåŒ–è§£å†³æ–¹æ¡ˆ

#### å‚æ•°é•¿åº¦å›ºå®š

``` js
const curry = (fn) =>(judge = (...args) => args.length === fn.length ? fn(...args) : (...arg) => judge(...args, ...arg));
const add = (a, b, c) => a + b + c;
const curryAdd = curry(add);
console.log(curryAdd(1)(2)(3)); // 6
console.log(curryAdd(1, 2)(3)); // 6
console.log(curryAdd(1)(2, 3)); // 6
```

#### å‚æ•°é•¿åº¦ä¸å›ºå®š

``` js
function add (...args) {
  //æ±‚å’Œ
  return args.reduce((a, b) => a + b);
}

function currying (fn) {
  let args = [];

  return function temp (...newArgs) {
    if (newArgs.length) {
      args = [
        ...args,
        ...newArgs
      ];
      return temp;
    } else {
      let val = fn.apply(this, args);
      args = []; //ä¿è¯å†æ¬¡è°ƒç”¨æ—¶æ¸…ç©º
      return val;
    }
  }
}

let addCurry = currying(add);
console.log(addCurry(1)(2)(3)(4, 5)());  //15
console.log(addCurry(1)(2)(3, 4, 5)());  //15
console.log(addCurry(1)(2, 3, 4, 5)());  //15
```

## äº‹ä»¶ä¾¦å¬å™¨ï¼Œå…¼å®¹æµè§ˆå™¨

``` js
var eventUtil = {
  getEvent: function(event) {
      return event || window.event;
  },

  getTarget: function(event) {
      return event.target || event.srcElement;
  },

  addListener: function(element, type, hander) {
      if (element.addEventListener) {
          element.addEventListener(type, hander, false);
      } else if (element.attachEvent) {
          element.attachEvent('on' + type, hander);
      } else {
          element['on' + type] = hander;
      }
  },

  removeListener: function(element, type, hander) {
      if (element.removeEventListener) {
          element.removeEventListener(type, hander, false);
      } else if (element.deattachEvent) {
          element.detachEvent(type, hander);
      } else {
          element['on' + type] = null;
      }
  },

  preventDefault: function(event) {
      if (event.preventDefault) {
          event.preventDefault();
      } else {
          event.returnValue = false;
      }
  },

  stopPropagation: function(event) {
      if (event.stopPropagation) {
          event.stopPropagation();
      } else {
          event.cancelBubble = true;
      }
  }
};

// è°ƒç”¨
(function() {
  var btn = document.getElementById("btn");
  var link = document.getElementsByTagName("a")[0];

  eventUtil.addListener(btn, "click", function(event) {
      var event = eventUtil.getEvent(event);
      var target = eventUtil.getTarget(event);
      alert(event.type);
      alert(target);
      eventUtil.stopPropagation(event);
  });

  eventUtil.addListener(link, "click", function(event) {
      alert("prevent default event");
      var event = eventUtil.getEvent(event);
      eventUtil.preventDefault(event);
  });

  eventUtil.addListener(document.body, "click", function() {
      alert("click body");
  });
})();
```

## äº‹ä»¶æ¨¡å‹

``` js
var Event = (function () {
    var list = {}, bind, trigger, remove;
    bind = function (key, fn) {
        if (!list[key]) {
            list[key] = [];
        }
        list[key].push(fn);
    };
    trigger = function () {
        var key = Array.prototype.shift.call(arguments);
        var fns = list[key];
        if (!fns || fns.length === 0) {
            return false;
        }
        for (var i = 0, fn; fn = fns[i++];) {
            fn.apply(this, arguments);
        }
    };
    remove = function (key, fn) {
        var fns = list[key];
        if (!fns) {
            return false;
        }
        if (!fn) {
            fns & (fns.length = 0);
        } else {
            for (var i = fns.length - 1; i >= 0; i--) {
                var _fn = fns[i];
                if (_fn === fn) {
                    fns.splice(i, 1);
                }
            }
        }
    };
    return {
        bind: bind,
        trigger: trigger,
        remove: remove
    }
})();

// è°ƒç”¨
Event.bind('Hit', function(){ console.log('bind event'); }); // ç»‘å®šäº‹ä»¶
Event.trigger("Hit", function(){ console.log('trigger event'); }); // è§¦å‘äº‹ä»¶
```

## äº‹ä»¶ä»£ç†ï¼Œå…¼å®¹æµè§ˆå™¨

``` js
function delegateEvent(parentEl, selector, type, fn) {
    var handler = function(e){
          var e = e || window.event;
          var target = e.target || e.srcElement;
          if (matchSelector(target, selector)) {
              if(fn) {
                  fn.call(target, e);
              }
          }
    };
    if(parentEl.addEventListener){
        parentEl.addEventListener(type, handler);
    }else{
        parentEl.attachEvent("on" + type, handler);
    }
}
/**
 * support #id, tagName, .className
 */
function matchSelector(ele, selector) {
    // if use id
    if (selector.charAt(0) === "#") {
        return ele.id === selector.slice(1);
    }
    // if use class
    if (selector.charAt(0) === ".") {
        return (" " + ele.className + " ").indexOf(" " + selector.slice(1) + " ") != -1;
    }
    // if use tagName
    return ele.tagName.toLowerCase() === selector.toLowerCase();
}

// è°ƒç”¨
var box = document.getElementById("box");
delegateEvent(box, "a", "click", function(){
    console.log(this.href);
})
```

## äº‹ä»¶è§¦å‘å™¨ï¼Œå…¼å®¹æµè§ˆå™¨

``` js
var fireEvent = function(element, event){
    if (document.createEventObject){
        var mockEvent = document.createEventObject();
        return element.fireEvent('on' + event, mockEvent)
    }else{
        var mockEvent = document.createEvent('HTMLEvents');
        mockEvent.initEvent(event, true, true);
        return element.dispatchEvent(mockEvent);
    }
}
```

## Function.bind å‡½æ•°**

``` js
if (!Function.prototype.bind) {
  Function.prototype.bind = function (oThis) {
    if (typeof this !== "function") {
      throw new TypeError("'this' is not function");
    }

    // bind's default arguments, array without first element
    // first part arguments for the function
    var aBindArgs = Array.prototype.slice.call(arguments, 1);
    var fToBind = this; // the function will be binding
    var fNOP = function () {};
    var fBound = function () {
          // target this will be binding
          var oThis = this instanceof fNOP ? this : oThis || this;
          // last part arguments for the function
          var aCallArgs = Array.prototype.slice.call(arguments);
          // complete arguments for the function
          var aFuncArgs = aBindArgs.concat(aCallArgs);
          return fToBind.apply(oThis, aFuncArgs);
        };

    // fBound extends fToBind
    fNOP.prototype = this.prototype;
    fBound.prototype = new fNOP();

    return fBound;
  };
}

// è°ƒç”¨
var add = function(a, b, c){ return a + b + c;};
var newAdd = add.bind(null, 1, 2);
var result = newAdd(3);
```

## æ•°ç»„å¿«é€Ÿæ’åº

``` js
var quickSort = function(arr) {
    if (arr.length <= 1) { return arr; }
    var pivotIndex = Math.floor(arr.length / 2);
    var pivot = arr.splice(pivotIndex, 1)[0];
    var left = [];
    var right = [];
    for (var i = 0, len = arr.length; i < len; i++){
        if (arr[i] < pivot) {
          left.push(arr[i]);
        } else {
          right.push(arr[i]);
        }
    }
    return quickSort(left).concat([pivot], quickSort(right));
};

// è°ƒç”¨
quickSort([9, 4, 2, 8, 1, 5, 3, 7]);
```

## æ•°ç»„å†’æ³¡æ’åº

``` js
var bubble = function(arr){
    var maxIndex = arr.length - 1, temp, flag;
    for (var i = maxIndex; i > 0; i--) {
        flag = true
        for (var j = 0; j < i; j++) {
            if (arr[j] > arr[j + 1]) {
                temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
                flag = false;
            }
        }
        if(! flag){
            break;
        }
    }
    return arr;
}
// è°ƒç”¨
var arr = bubble([13, 69, 28, 93, 55, 75, 34]);
```

## æ•°ç»„å»é‡


``` js
Array.prototype.unique = function() { return [...new Set(this)];};
// è°ƒç”¨
[1, 2, 3, 3, 2, 1].unique();

function unique1(arr){
    var hash = {}, result = [];
    for(var i=0, len=arr.length; i<len; i++){
        if(! hash[arr[i]]){
          result.push(arr[i]);
          hash[arr[i]] = true;
        }
    }
    return result;
}
// è°ƒç”¨
unique1([1, 2, 3, 3, 2, 1]);

Array.prototype.unique2 = function(){
    this.sort();
    var result = [this[0]];
    var len = this.length;
    for(var i = 0; i < len; i++){
        if(this[i] !== result[result.length - 1]){
          result.push(this[i]);
        }
    }
    return result;
}
// è°ƒç”¨
[1, 2, 3, 3, 2, 1].unique2();

function unique3(arr){
    var result = [];
    for(var i=0; i<arr.length; i++){
        if(result.indexOf(arr[i]) == -1){
          result.push(arr[i]);
        }
    }
    return result;
}

// è°ƒç”¨
unique3([1, 2, 3, 3, 2, 1]);
```

## å°†urlçš„æŸ¥è¯¢å‚æ•°è§£ææˆå­—å…¸å¯¹è±¡


``` js
function parseQuery(url) {
  url = url == null ? window.location.href : url;
  var search = url.substring(url.lastIndexOf("?") + 1);
  var hash = {};
  var reg = /([^?&=]+)=([^?&=]*)/g;
  search.replace(reg, function (match, $1, $2) {
      var name = decodeURIComponent($1);
      var val = decodeURIComponent($2);
      hash[name] = String(val);
      return match;
  });
  return hash;
}
```

## èŠ‚æµå‡½æ•°

``` js
var throttle = function(fn, delay, mustRunDelay){
  var timer = null;
  var t_start;
  return function(){
    var context = this, args = arguments, t_curr = +new Date();
    clearTimeout(timer);
    if(!t_start){
      t_start = t_curr;
    }
    if(t_curr - t_start >= mustRunDelay){
      fn.apply(context, args);
      t_start = t_curr;
    } else {
      timer = setTimeout(function(){
        fn.apply(context, args);
      }, delay);
    }
  };
};

// è°ƒç”¨ï¼ˆä¸¤æ¬¡é—´éš”50mså†…è¿ç»­è§¦å‘ä¸æ‰§è¡Œï¼Œä½†æ¯ç´¯è®¡100msè‡³å°‘æ‰§è¡Œä¸€æ¬¡
window.onresize = throttle(myFunc, 50, 100);
```

## åƒä½åˆ†éš”ç¬¦

``` js
function test1(num){
  var str = (+ num) + '';
  var len = str.length;
  if(len <= 3) return str;
  num = '';
  while(len > 3){
      len -= 3;
      num = ',' + str.substr(len, 3) + num;
  }
  return str.substr(0, len) + num;
}

function test2(num){
  // ?= æ­£å‘åŒ¹é…:åŒ¹é…ä½ç½®
  // ?! æ­£å‘ä¸åŒ¹é…:æ’é™¤ä½ç½®
  var str = (+num).toString();
  var reg = /(?=(?!\b)(\d{3})+$)/g;
  return str.replace(reg, ',');
}
```